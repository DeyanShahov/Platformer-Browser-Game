{"type":"entity","name":"platformer-game:project","entityType":"software_project","observations":["Title: Platformer Browser Game with Z-Depth Physics","Description: Advanced 2D platformer game featuring 3D collision system, AI behavior trees, skill progression, and modular architecture","Language: Vanilla JavaScript (no frameworks)","Rendering: HTML5 Canvas API (1920x1080 resolution)","Architecture: Modular system-based design with clean separation of concerns","Unique Features: Z-depth collision system, Behavior Tree AI, Micro skill trees, Multiplayer support","Status: Active development (Last Updated: January 2026)","Complexity: High (6 major integrated systems: Combat, Animation, AI, Skill, Collision, Rendering)","Performance: 60 FPS target, optimized rendering pipeline","Code Quality: Comprehensive documentation, consistent patterns, Bulgarian localization"]}
{"type":"entity","name":"platformer-game:technology-stack","entityType":"technology","observations":["Vanilla JavaScript: Core game logic, no frameworks, maximum performance","HTML5 Canvas API: 2D graphics rendering with Z-depth simulation, hardware accelerated","Z-Depth Physics: Custom 3D collision system in 2D space using X, Y, Z coordinates","Benefits: Full control, lightweight, depth-based collision detection, unique 2.5D gameplay"]}
{"type":"entity","name":"platformer-game:combat-system","entityType":"game_system","observations":["Purpose: Combat resolution and damage calculation engine","Files: combat_system.js","Classes: CombatAttributes (base stats), CombatCalculator (damage formulas), CombatResolver (attack flow), EnemyCombatManager (enemy coordination), DamageNumberManager (UI feedback)","Player Attack Formula: baseAttack + strength + equipment + buffs - debuffs + skillModifier","Enemy Attack Formula: baseAttack * animation-based multiplier (attackBox.width/30)","Defense: baseDefense + armor + shield + buffs - debuffs (enemies: baseDefense + (level-1)*2)","Critical Hits: 10% for players, 5% for enemies, 2x damage multiplier","Accuracy System: 70% base + skillModifier ± dodgeChance","Resource Management: Mana (magical skills), Energy (physical skills) via ResourceManager","Combat Events: Logging with max 50 entries, timestamp tracking, damage details","Enemy Coordination: 1.5 second cooldown between enemy attacks via Cooldown decorator","Death Handling: 1.5s blinking animation, entity removal, experience/gold rewards","Experience Rewards: enemy XP scaled by level, Gold rewards for economy","Unified Combat: All entities use CombatResolver.resolveAttack() or resolveAttackNoResourceCheck()","Integration: character_info.js, skill system, animation system for attack timing"]}
{"type":"entity","name":"platformer-game:animation-system","entityType":"game_system","observations":["Purpose: Animation management and sprite rendering system","Files: Animation System/ folder (7 files): animation_data.js, animation_renderer.js, animation_state_machine.js, animation_system.js, animation_utils.js, entity_animation.js, sprite_manager.js","Architecture: 5-phase refactoring completed December 2025 for clean separation of concerns","Classes: AnimationStateMachine (state transitions), AnimationRenderer (all entity drawing), SpriteManager (asset loading/caching), EntityAnimation (per-entity state)","Data System: animation_data.js contains pure data (ANIMATION_TYPES, SPRITE_CONFIGS, ANIMATION_DEFINITIONS)","Per-frame Collision Data: frameData.hitBox and attackBox for precise collision timing","Z-Depth Rendering: getZOffset() method for unified depth calculations, Z-sorting for proper rendering order","State Machines: Player states (idle/walking/running/jumping/attack variants), Enemy states (idle/walking/running/attack/hurt/dead)","Rendering: Centralized AnimationRenderer handles ALL entity drawing (sprites, shapes), batch rendering, sprite caching","Performance: 60 FPS target, optimized canvas operations, memory management","Debug Features: Visual hit boxes, attack boxes, collision borders, Z-lines, entity labels","Entity Types Supported: Players (knight), enemies (generic rectangles, blue_slime with sprites)","Benefits after refactoring: No code duplication, centralized logic, maintainable changes, consistent API"]}
{"type":"entity","name":"platformer-game:ai-system","entityType":"game_system","observations":["Purpose: Enemy AI using Behavior Tree + FSM architecture","Files: Behavior Tree/ folder (6 files), base_enemy.js, blue_slime.js","Architecture: FSM (state management) + BT (decision making) + Script system (custom behaviors)","BT Node Types: Selector (priority OR), Sequence (AND), Decorator (Cooldown), Condition (checks), Action (commands)","BT Commands: idle, patrol, chase, attack, move_up, move_down","Rarity System: common/basic, elite/normal, boss/advanced with different behavior complexity","Intelligence Scaling: basic (3s thinking), advanced (2s), expert (1.5s) durations","Thinking Phase: Idle state with negative timer for strategic BT consultation","Pending Command System: Queue commands during thinking for smooth transitions","Script Types: FULL (100% override), PARTIAL (30-70% merge), BONUS (10-30% enhancement)","Script Manager: Async loading with LRU caching (default 20 scripts), validation, performance monitoring","Boss Phase System: HP-based transitions (100%→66%→33%), capability changes, attack profile switching","Target Selection: X-Z distance calculations for 2.5D, awareness radius by rarity (common:300, elite:350, boss:500)","Constraint-Based AI: getBehaviorConstraints() for boundary and obstacle-aware movement","Vertical Movement: targetZ system with vz velocity and Z_MIN/Z_MAX boundaries","Collision Awareness: Direct attack on player collision, boundary interruption triggers BT consultation","Debug: window.debugEnemyScripts interface, comprehensive logging"]}
{"type":"entity","name":"platformer-game:base-enemy-system","entityType":"ai_implementation","observations":["Purpose: Universal foundation for all enemy types","Files: base_enemy.js (1000+ lines), blue_slime.js (subclass example)","BaseEnemy Class: Universal AI inheritance with BT integration, FSM control, combat integration","BlueSlime Implementation: Common rarity, light attacks, sprite-based animation, stats scaling (80+20/lvl HP, 8+2/lvl attack)","Initialization: Constructor with position, level, rarity, intelligence, scriptConfig parameters","BT Setup: initializeBT() with universal factory, createAttackProfile() for attack types","FSM States: enemy_idle, enemy_walking, enemy_running, enemy_attack variants","Combat Integration: CharacterInfo for stats, takeDamage() and die() methods, experience/gold rewards","Command Execution: executePendingCommand() with immediate arcade-style execution","Performance: Batch operations, caching, async script loading without blocking","Rewards: BlueSlime gives 150 + 50/level XP, 15 + 5/level gold"]}
{"type":"entity","name":"platformer-game:skill-system","entityType":"game_system","observations":["Purpose: Character progression and ability system","Files: skills.js, micro_skill_tree.js, data/skill-data.js","Classes: SkillTreeManager (unlocking/leveling), MicroSkillTreeManager (4 progression systems)","Progression Systems: OnePerRowSystem (1 skill/row, requires previous), LevelBasedSystem (unlocks at levels 3,5,7,10), AbsoluteSystem (all available for 1 point), InstantSystem (one/row, no cost)","Skill Leveling: Dynamic costs via levelCosts array, getSkillPointCost() calculations","Prerequisites: skill_level, player_level, quest_completed, achievement_unlocked types","Resource System: MANA (magical), ENERGY (physical), NONE types with data-driven costs","Combat Integration: damageModifier, accuracyModifier, criticalChanceModifier, cooldownModifier, targetCountModifier","Passive Effects: levelEffects arrays apply bonuses per level upgrade","UI: 6×5 grid layout (30 positions), WASD/arrow navigation, visual states (Available/Unlocked/Locked)","Multi-player: Keys 5-8 for players 1-4 skill tree access, debounce protection","Skill Points: 2 awarded per level for ability unlocking"]}
{"type":"entity","name":"platformer-game:collision-system","entityType":"game_system","observations":["Purpose: 3D collision detection with Z-depth support","Files: collision.js (600+ lines) - CENTRALIZED collision and boundary functions","Z-Depth Collision: X, Y, Z coordinate system with effectiveZThickness = azThickness + tzThickness","Z-Tolerance: 30 units for movement, 10 units for attacks","Buffer System: AI (8px smooth movement), Player (2px precision), Attacks (0px exact)","Main Functions: checkEntityCollision() (unified per-frame), checkHitboxCollision() (attack timing), applyCollisionCorrection() (separation vector), canMoveTo() (movement validation), getBehaviorConstraints() (AI constraints), applyScreenBoundaries() (boundary enforcement)","IMPORTANT: getBehaviorConstraints() and applyScreenBoundaries() are ONLY in collision.js - game.js calls via window.XXX","Constraint System: move_up/move_down are blocked when at boundaries but NOT added to allowed set (prevents NaN targetZ from BT)","Per-frame Data: Uses animation frameData.hitBox/attackBox instead of static dimensions","Mirroring System: Center-based attack/hit box flipping for left-facing entities","Separation Vector: Overlap calculation with equal split for collision correction","Performance: Batch collision detection, spatial partitioning concepts, early exit optimizations","Integration: Animation system for per-frame data, combat system for damage timing, AI for constraints","Debug: Visual collision boxes, hurt boxes, attack ranges"]}
{"type":"entity","name":"platformer-game:rendering-system","entityType":"game_system","observations":["Purpose: UI rendering coordination and debug visualization","Files: render.js","Architecture: UI coordination layer, separated from entity drawing (AnimationRenderer handles entities)","Responsibilities: Debug visualization (Z-lines, entity labels, collision boxes), damage numbers, UI overlays","Layers: Background, entities (via AnimationRenderer), UI overlays, debug information","Z-Depth: Unified Z calculations across all rendering via getZOffset()","Entity Sorting: getSortedEntitiesForRendering() with Y-Z coordinate calculation","Performance: 60 FPS target, optimized canvas operations","Multiplayer: Supports rendering multiple player views","Integration: Calls AnimationRenderer.drawAnimatedEntities() for all entities"]}
{"type":"entity","name":"platformer-game:character-info-system","entityType":"progression_system","observations":["Purpose: Character progression with statistics, leveling, experience","Files: character_info.js","Classes: CharacterInfo (stats, leveling, experience management)","Multi-character: blue, orange, green, red with Bulgarian display names (Син/Оранжев/Зелен/Червен герой)","Experience System: Level * 100 XP for next level, automatic level progression, multi-level support","Stat Distribution: Strength (damage), Speed (movement), Intelligence (magic) - all start at 10","Automatic Increases: +1 to each stat per level, 5 free points for manual distribution","Level-up Rewards: Full HP/mana/energy recovery, 2 skill points per level","UI Methods: modifyStrength/Speed/Intelligence() with validation, prevents stats below auto-level minimum","Combat Integration: Links with combat system for stat-based damage calculations"]}
{"type":"entity","name":"platformer-game:enemy-data-system","entityType":"data_system","observations":["Purpose: Enemy types, stats, and rewards management","Files: enemy_data.js","Classes: EnemyData (level scaling, rewards, type definitions)","Enemy Types: Basic (50 HP, 3 atk, 200 XP), Elite (100 HP, 6 atk, 500 XP), Boss (2100 HP, 12 atk, 2000 XP)","Level Scaling: 20% stat increase per level via formula: stat * (1 + (level-1) * 0.2)","Preserved Stats: Critical chance and speed don't scale with level","Rewards: Experience and gold scale with level, framework for item drops","Bulgarian Names: 'Основен враг', 'Елитен враг', 'Бос'"]}
{"type":"entity","name":"platformer-game:game-state-management","entityType":"core_infrastructure","observations":["Purpose: Centralized entity storage and lifecycle management","Files: game_state.js (150+ lines)","Classes: GameState (entity Map, player array, lifecycle methods)","Storage: Map-based (ID → entity) for O(1) access, separate players array for backwards compatibility","Entity Lifecycle: addEntity() with auto ID assignment, removeEntity() with cleanup","Queries: getEntitiesByType(), getAllEntities(), getEntity(), hasEntity(), getEntityCount()","Entity Types: 'player', 'enemy', 'ally', 'neutral' classification","Debug: getDebugInfo() with real-time statistics and entity type breakdowns","Performance: Map-based lookups, efficient entity filtering","Integration Hub: AI, combat, rendering, physics systems all access entities through GameState"]}
{"type":"entity","name":"platformer-game:game-loop-system","entityType":"core_system","observations":["Purpose: Main game orchestration and update/render cycle","Files: game.js (900+ lines)","Architecture: RequestAnimationFrame loop with delta time tracking, update/render separation","Initialization: Canvas setup (1920x1080), async animation system init, player/enemy creation","Character Selection: 4-player system with keyboard (1-4) and gamepad support, Bulgarian names","Input Integration: Skill tree keys (5-8), stats keys (9/0/-/=), tab navigation (t/y/u/i), 300ms debounce","Combat Resolution: FSM-based attack detection, collision checks, damage flags to prevent multi-hit","Enemy Management: BT updates for BlueSlime, simple AI fallback for others, death/respawn handling","Resource Regeneration: Per-entity mana/energy recovery via ResourceManager","Menu System: Per-player skill tree and stats windows, input filtering during menus","Entity Sorting: Z-depth sorting for 2.5D rendering order","Debug: Comprehensive Bulgarian console logging, development shortcuts"]}
{"type":"entity","name":"platformer-game:input-handling-system","entityType":"input_system","observations":["Purpose: Keyboard/gamepad input with state-based filtering","Files: input.js (50+ lines)","Architecture: DOM keydown/keyup events with capture phase priority","Key State: Global window.keys object for cross-module access","State Filtering: Gameplay keys only work when !menuActive && gameStateString !== 'start'","Menu Key Priority: Escape, m, 5-8, 9/0/-/=, t/y/u/i always work regardless of game state","Event Capture: capture: true ensures input priority over other handlers","Utility: isKeyPressed() helper function for clean key checking","Performance: Minimal processing, early exit for menu keys","Integration: Game loop polling, player controls, UI systems"]}
{"type":"entity","name":"platformer-game:resource-management","entityType":"infrastructure_system","observations":["Purpose: Asset loading, caching, and resource lifecycle","Files: resource_manager.js, load_skill_icon.js","ResourceManager: Centralized asset loading, caching, memory management for images/audio/sprites","Resource Types: MANA (magical skills), ENERGY (physical skills) with regeneration","Loading: Individual and batch preloading with progress tracking","Caching: Asset reuse, memory optimization, unloadUnusedAssets() cleanup","Skill Icons: 5×10 grid sprite sheet loading (Swordsman-Skill-Icons.webp), 65×65px icons","Consumption: Resource validation before skill execution, cost modifiers","Regeneration: Per-entity recovery during game loop updates"]}
{"type":"entity","name":"platformer-game:ui-architecture","entityType":"interface_system","observations":["Purpose: UI coordination and component management","Files: ui.js, menu.js, character_stats_ui.js","UI Coordinator: ui.js handles state management, component coordination, accessibility","Menu System: menu.js with state transitions, settings, controls configuration","Character Stats: character_stats_ui.js for stats panels, progress bars, overlays","Health Display: Color-coded (green/yellow/orange/red), Bulgarian status text ('Жив', 'Ранен', 'Критично')","Input Handling: UI-specific input, mouse/keyboard/controller support","Accessibility: Screen reader support, keyboard navigation, visual feedback"]}
{"type":"entity","name":"platformer-game:localization-system","entityType":"localization","observations":["Purpose: Bulgarian language support throughout the game","Coverage: Character names (Син/Оранжев/Зелен/Червен герой), enemy names (Основен враг/Елитен враг/Бос), health status (Жив/Ранен/Критично), console messages, UI feedback, code comments","Files: Distributed across character_info.js, enemy_data.js, game.js, input.js","Cultural Adaptation: Native Bulgarian terms for game immersion"]}
{"type":"entity","name":"platformer-game:development-guidelines","entityType":"standards_documentation","observations":["Files: PROJECT_FILE_GUIDE.md","Coding Standards: Vanilla JavaScript only, conservative library usage, consistent patterns","Testing: Development scripts, debug interfaces, visual testing tools","Performance: 60 FPS target, optimized rendering, memory management","Integration Patterns: Follow existing file organization and system boundaries","Documentation: Code comments, API documentation, Bulgarian language support"]}
{"type":"entity","name":"platformer-game:problems-solutions","entityType":"implementation_knowledge","observations":["AI засядане при колизии → Collision correction с AI буфер (8px)","Непоследователни AI transitions → Pending command queuing system","Infinite idle loops → Thinking phase с strategic BT consultation","Неточни attack collisions → Per-frame animation data вместо static boxes","Hit box mirroring → Център-базирано mirroring при facing left","Unified combat system → Entity type branching в calculateAttackPower()","Z-depth collision complexity → Z-толеранс система с effective thickness","Animation-based balance → Attack box width → damage multiplier conversion","Resource management → ResourceManager abstraction layer","BT context updates → updateBTContext() с current game state","Code duplication (Jan 2026) → getBehaviorConstraints/applyScreenBoundaries centralized ONLY in collision.js, game.js calls via window.XXX","NaN targetZ bug → move_up/move_down NOT added to allowed set in getBehaviorConstraints(), prevents BT from selecting vertical movement without speed/displacement params","Infinite recursion bug → Wrapper functions cause stack overflow, use direct window.XXX calls instead"]}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:combat-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:animation-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:ai-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:skill-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:collision-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:rendering-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:character-info-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:enemy-data-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:game-state-management","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:game-loop-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:input-handling-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:resource-management","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:ui-architecture","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:localization-system","relationType":"contains"}
{"type":"relation","from":"platformer-game:project","to":"platformer-game:technology-stack","relationType":"built_with"}
{"type":"relation","from":"platformer-game:ai-system","to":"platformer-game:base-enemy-system","relationType":"implements_via"}
{"type":"relation","from":"platformer-game:combat-system","to":"platformer-game:collision-system","relationType":"depends_on"}
{"type":"relation","from":"platformer-game:combat-system","to":"platformer-game:animation-system","relationType":"coordinates_with"}
{"type":"relation","from":"platformer-game:combat-system","to":"platformer-game:skill-system","relationType":"integrates_with"}
{"type":"relation","from":"platformer-game:combat-system","to":"platformer-game:character-info-system","relationType":"uses_stats_from"}
{"type":"relation","from":"platformer-game:ai-system","to":"platformer-game:collision-system","relationType":"depends_on"}
{"type":"relation","from":"platformer-game:ai-system","to":"platformer-game:animation-system","relationType":"integrates_with"}
{"type":"relation","from":"platformer-game:ai-system","to":"platformer-game:combat-system","relationType":"triggers"}
{"type":"relation","from":"platformer-game:rendering-system","to":"platformer-game:animation-system","relationType":"coordinates_with"}
{"type":"relation","from":"platformer-game:collision-system","to":"platformer-game:animation-system","relationType":"uses_frame_data_from"}
{"type":"relation","from":"platformer-game:skill-system","to":"platformer-game:resource-management","relationType":"uses"}
{"type":"relation","from":"platformer-game:skill-system","to":"platformer-game:ui-architecture","relationType":"displays_via"}
{"type":"relation","from":"platformer-game:skill-system","to":"platformer-game:character-info-system","relationType":"enhances_progression"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:animation-system","relationType":"orchestrates"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:combat-system","relationType":"orchestrates"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:ai-system","relationType":"orchestrates"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:rendering-system","relationType":"orchestrates"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:input-handling-system","relationType":"polls"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:resource-management","relationType":"updates"}
{"type":"relation","from":"platformer-game:game-loop-system","to":"platformer-game:game-state-management","relationType":"manages"}
{"type":"relation","from":"platformer-game:input-handling-system","to":"platformer-game:ui-architecture","relationType":"supports"}
{"type":"relation","from":"platformer-game:input-handling-system","to":"platformer-game:skill-system","relationType":"triggers"}
{"type":"relation","from":"platformer-game:game-state-management","to":"platformer-game:ai-system","relationType":"provides_entities_for"}
{"type":"relation","from":"platformer-game:game-state-management","to":"platformer-game:combat-system","relationType":"provides_entities_for"}
{"type":"relation","from":"platformer-game:game-state-management","to":"platformer-game:collision-system","relationType":"provides_entities_for"}
{"type":"relation","from":"platformer-game:game-state-management","to":"platformer-game:rendering-system","relationType":"provides_entities_for"}
{"type":"relation","from":"platformer-game:enemy-data-system","to":"platformer-game:base-enemy-system","relationType":"provides_stats_for"}
{"type":"relation","from":"platformer-game:enemy-data-system","to":"platformer-game:character-info-system","relationType":"provides_rewards_for"}
{"type":"relation","from":"platformer-game:base-enemy-system","to":"platformer-game:combat-system","relationType":"integrates_with"}
{"type":"relation","from":"platformer-game:base-enemy-system","to":"platformer-game:animation-system","relationType":"uses"}
{"type":"relation","from":"platformer-game:localization-system","to":"platformer-game:character-info-system","relationType":"localizes"}
{"type":"relation","from":"platformer-game:localization-system","to":"platformer-game:enemy-data-system","relationType":"localizes"}
{"type":"relation","from":"platformer-game:localization-system","to":"platformer-game:ui-architecture","relationType":"localizes"}
{"type":"relation","from":"platformer-game:problems-solutions","to":"platformer-game:collision-system","relationType":"documents_fixes_for"}
{"type":"relation","from":"platformer-game:problems-solutions","to":"platformer-game:combat-system","relationType":"documents_fixes_for"}
{"type":"relation","from":"platformer-game:problems-solutions","to":"platformer-game:ai-system","relationType":"documents_fixes_for"}
{"type":"relation","from":"platformer-game:problems-solutions","to":"platformer-game:animation-system","relationType":"documents_fixes_for"}
{"timestamp": "2026-01-14T01:18:00+02:00", "type": "architecture_decision", "title": "Enemy AI: Probabilistic Movement & Universal Factory Fix", "tags": ["ai", "behavior-tree", "movement", "fix"], "description": "Resolved persistent vertical movement loop in Blue Slime AI. Implemented `RandomSelector` to enforce a 50/50 probabilistic choice between `Patrol` and `Vertical Movement` (when available). Added `Cooldown` (15s) to vertical movement to prevent spam. Crucially, identified and fixed a discrepancy where `createUniversalEnemyBehaviorTree` (used by BaseEnemy) was missing these updates compared to `createScriptEnabledBT`. Updated the universal factory to match the script-enabled one, ensuring all enemies usage the robust random selection logic.", "files": ["Behavior Tree/enemyAI_BT.js", "base_enemy.js"]}
{"timestamp": "2026-01-14T03:50:00+02:00", "type": "architecture_decision", "title": "Animation & Physics v2: Universal Flip & Timing Fixes", "tags": ["animation", "physics", "rendering", "fix"], "description": "Major overhaul of Animation-Physics synchronization. 1) **Universal Flip Center:** Visual flipping now pivots dynamically around the hitBox center (`entity.x + offset + width/2`) in `animation_renderer.js`, decoupling it from sprite offsets. 2) **Static Physics:** Disabled physical hitbox mirroring in `collision.js`. Hitboxes now remain static relative to `entity.x`, allowing precise manual offsets in `animation_data.js` without desync. 3) **Duration-Based Logic:** Fixed `EnemyAttackState` premature exit. Replaced frame-index check (`currentFrame >= totalFrames-1`) with duration check (`animationTime >= duration`), ensuring animations play their full length regardless of frame count.", "files": ["Animation System/animation_renderer.js", "collision.js", "Animation System/animation_state_machine.js"]}
